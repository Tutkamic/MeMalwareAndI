using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class MalwareChooseHandler : MonoBehaviour
{
    [SerializeField] GameModeSO currentGameMode;
    [SerializeField] BoolVariableSO isFloorCalculationFinish;
    [SerializeField] GameObject[] Buttons;

    private CharacterStateManager characterStateManager;

    private void Awake()
    {
        characterStateManager = FindObjectOfType<CharacterStateManager>();
    }

    private void Update()
    {
        if (currentGameMode.GameMode == GameMode.VirusSelection)
        {
            GetKeyboardInput();
            SetButtonActive(true);
        }
        else
        {
            SetButtonActive(false);
        }
    }

    private void SetButtonActive(bool isActive)
    {
        foreach (var button in Buttons)
        {
            button.SetActive(isActive);
        }
    }

    private void GetKeyboardInput()
    {
        if (!isFloorCalculationFinish.GetValue) return;

        if (Input.GetKeyDown(KeyCode.Alpha1)) characterStateManager.SetMalwareState(1);
        if (Input.GetKeyDown(KeyCode.Alpha2)) characterStateManager.SetMalwareState(2);
        if (Input.GetKeyDown(KeyCode.Alpha3)) characterStateManager.SetMalwareState(3);
    }

    public void SetMalware(int num)
    {
        if (currentGameMode.GameMode != GameMode.VirusSelection) return;
        characterStateManager.SetMalwareState(num);
    }
}
