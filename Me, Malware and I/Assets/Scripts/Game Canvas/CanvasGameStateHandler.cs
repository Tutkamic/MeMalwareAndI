using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using TMPro;

public class CanvasGameStateHandler : MonoBehaviour
{
    [SerializeField] private UnityEngine.UI.Button[] malwareButtons;
    [SerializeField] private TextMeshProUGUI[] malwareButtonsText;
    [SerializeField] private UnityEngine.UI.Button changeTourButton;
    [SerializeField] private TextMeshProUGUI changeTourText;
    [SerializeField] GameModeSO currentGameMode;

    private float alphaColorInactive = 0.1f;
    private float glowActive = 0.3f;

    private void Update()
    {
        if (currentGameMode.GameMode == GameMode.VirusSelection) MalwareChooseTour();
        else if (currentGameMode.GameMode == GameMode.PlayerTour) PlayerTour();
        else if (currentGameMode.GameMode == GameMode.EnemyTour) EnemyTour();
    }
    private void Start()
    {
        SetButtonActive(false);
        ChangeTourButtonInactive();
    }

    private void SetButtonActive(bool isActive)
    {
        for (int i = 0; i < malwareButtons.Length; i++)
        {
            malwareButtons[i].interactable = isActive;
            float alphaColor = isActive ? 1f : alphaColorInactive;
            malwareButtonsText[i].color = new Color(malwareButtonsText[i].color.r, malwareButtonsText[i].color.g, malwareButtonsText[i].color.b, alphaColor);

            float glowPower = isActive ? glowActive : 0f;
            var materialtext = malwareButtonsText[i].fontMaterial;
            materialtext.SetFloat("_GlowPower", glowPower);
        }
    }
    public void MalwareChooseTour()
    {
        changeTourText.text = "START";
        SetButtonActive(true);
        ChangeTourButtonActive();
    }

    public void PlayerTour()
    {
        SetButtonActive(false);
        changeTourText.text = "SKIP";
    }

    public void EnemyTour()
    {
        ChangeTourButtonInactive();
    }


    private void ChangeTourButtonInactive()
    {
        changeTourButton.interactable = false;
        changeTourText.color = new Color(changeTourText.color.r, changeTourText.color.g, changeTourText.color.b, alphaColorInactive);
        var materialtext = changeTourText.fontMaterial;
        materialtext.SetFloat("_GlowPower", 0f);
    }
    private void ChangeTourButtonActive()
    {
        changeTourButton.interactable = true;
        changeTourText.color = new Color(changeTourText.color.r, changeTourText.color.g, changeTourText.color.b, 1f);
        var materialtext = changeTourText.fontMaterial;
        materialtext.SetFloat("_GlowPower", glowActive);
    }

}
